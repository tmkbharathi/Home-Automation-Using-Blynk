# Home Automation with Blynk and PicSimLab

This project implements a smart home automation system using an Arduino UNO, controllable via the Blynk IoT App and simulated on PicSimLab. It features:
- Garden Light control based on ambient light (LDR)
- Temperature monitoring with automatic heater control
- Water level monitoring with automatic inlet/outlet control

## Setup Instructions for PicSimLab

To run this project in simulation, you need to configure PicSimLab with the correct board and spare parts.

1. **Open PicSimLab** and set the Board to **Arduino UNO**.
2. **Load the Hex File**: Go to `File -> Load Hex` and select the `.hex` file generated by the Makefile (typically in `build/`).
3. **Configure the Spare Parts Window**:
   Open `Modules -> Spare Parts` and add the following components. Wire them exactly as listed below:
   
   - **LDR Sensor**: Connect to Analog Pin **A1** (for Garden light brightness control).
   - **LED (Garden Light)**: Connect to Digital Pin **3** (PWM pin to control brightness).
   - **Temperature System**: 
      - Heater: Connect to Digital Pin **5**.
      - Cooler: Connect to Digital Pin **4**.
      - Temperature Sensor (LM35): Connect to Analog Pin **A0**.
   - **Serial Tank**: This is handled via Serial communication (UART). No external pins need to be wired except ensuring standard TX/RX is active if required by the PIC simulator module.
   - **LCD 16x2 (I2C)**: Connect to the I2C pins.
      - SDA: **A4**
      - SCL: **A5**

4. **Connect to the Internet (Blynk Cloud)**: PicSimLab simulation needs to connect to the actual internet to communicate with the Blynk server.
   - Go to `Modules -> Serial Terminal` or `Options -> Network` in PicSimLab.
   - You need a virtual serial port pair (like **com0com** on Windows or `socat` on Linux).
   - Configure PicSimLab’s Arduino UNO **Serial** port to the first virtual COM port (e.g., `COM1`).
   - Run a python bridge or the provided **Blynk script** (`blynk-ser.bat` or `blynk-ser.sh` usually found in the Blynk library's `scripts` folder) on the second virtual COM port (e.g., `COM2`).
   - *Example Command*: `blynk-ser.bat -c COM2` - This command bridges the serial data from the simulator to the Blynk cloud via your computer's internet connection.

---

## Setup Instructions for Blynk IoT App

To control and monitor this system remotely, set up a template in your Blynk IoT Web Dashboard and App.

### 1. Web Dashboard (Template Creation)
1. Go to [Blynk Console](https://blynk.cloud) and create a new **Template**.
   - **Name**: Home automation
   - **Hardware**: Arduino UNO
   - **Connection Type**: Ethernet (or WiFi depending on your PicSimLab bridge)
2. Note down the **Template ID**, **Device Name**, and **Auth Token**. Update these at the top of the `home_automation_blynk_controlled.ino` file.

### 2. Datastreams Configuration
Create the following Datastreams in your Blynk Template under the **Datastreams** tab by clicking `New Datastream -> Virtual Pin`:

| Component / Function | Virtual Pin | Data Type | Min / Max | Description                       |
|----------------------|-------------|-----------|-----------|-----------------------------------|
| Cooler Control       | **V0**      | Integer   | 0 / 1     | Button to toggle cooler ON/OFF    |
| Temperature Gauge    | **V1**      | Double    | 0 / 100   | Gauge to display Temperature (°C) |
| Heater Control       | **V2**      | Integer   | 0 / 1     | Button to toggle heater ON/OFF    |
| Water Volume Gauge   | **V3**      | Integer   | 0 / 3000  | Gauge to display water volume (L) |
| Inlet Valve Control  | **V4**      | Integer   | 0 / 1     | Button to toggle Inlet ON/OFF     |
| Outlet Valve Control | **V5**      | Integer   | 0 / 1     | Button to toggle Outlet ON/OFF    |
| Terminal             | **V6**      | String    | N/A       | Terminal widget for text logs     |

### 3. Mobile App Dashboard Setup
Open the Blynk IoT app on your phone, navigate to your device, and add the following widgets connecting them to the respective Datastreams:

- **2x Button Widgets**: For Cooler (`V0`) and Heater (`V2`). Set Mode to 'Switch'.
- **2x Button Widgets**: For Inlet Valve (`V4`) and Outlet Valve (`V5`). Set Mode to 'Switch'.
- **2x Gauge Widgets**: For Temperature (`V1` - max 100) and Water Volume (`V3` - max 3000).
- **1x Terminal Widget**: For system notifications (`V6`).

## Running the Project
1. Compile the code using `make all`.
2. Upload the hex file to PicSimLab.
3. Open the Blynk App and start interacting with the buttons to see the simulated system respond in the PicSimLab Spare Parts window!
